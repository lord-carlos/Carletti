#opretter databasen
CREATE DATABASE  `carletti` ;

#opretter Depot
CREATE TABLE  `carletti`.`Depot` (
`name` VARCHAR( 255 ) NOT NULL ,
`description` TEXT NOT NULL ,
`maxX` INT NOT NULL ,
`maxY` INT NOT NULL ,
PRIMARY KEY (  `name` )
) ENGINE = INNODB;

#opretter ProductType
CREATE TABLE  `carletti`.`ProductType` (
`name` VARCHAR( 255 ) NOT NULL , #TODO tjek med en trigger
`processLine` VARCHAR ( 255 ) NOT NULL ,
`picture` TEXT NOT NULL ,
PRIMARY KEY (  `name` )
) ENGINE = INNODB;

#opretter IntermediateProduct
CREATE TABLE `carletti`.`IntermediateProduct` (
`id` VARCHAR( 255 ) PRIMARY KEY NOT NULL ,
`finished` TINYINT NOT NULL DEFAULT  '0',
`discarded` TINYINT NOT NULL DEFAULT  '0',
`quantity` DOUBLE NOT NULL,
`productType` VARCHAR( 255 ) NOT NULL,
INDEX `productTypeIndex` (productType),
FOREIGN KEY (productType) REFERENCES ProductType(name)
  ON DELETE CASCADE
,
`storingSpaceId` VARCHAR( 255 ) NOT NULL
#TODO tjek med en trigger om det er lovligt
) ENGINE = INNODB;


#opretter ProcessLine
CREATE TABLE `carletti`.`ProcessLine` (
`name` VARCHAR( 255 ) NOT NULL ,
`description` TEXT NOT NULL ,
`productType` VARCHAR( 255 ) NOT NULL , #TODO tjek med en trigger
PRIMARY KEY ( `name` )
) ENGINE = INNODB;


#opretter StoringSpace
CREATE TABLE `carletti`.`StoringSpace` (
`id` VARCHAR ( 255 ) NOT NULL PRIMARY KEY ,
`positionX` INT NOT NULL,
`positionY` INT NOT NULL,
`depot` VARCHAR( 255 ) NOT NULL,
INDEX `depotIndex` (depot),
FOREIGN KEY ( `depot` ) REFERENCES Depot(name)
  ON DELETE CASCADE
) ENGINE = INNODB;

#opretter Process
CREATE TABLE `carletti`.`Process` (
`id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`pikachu` VARCHAR ( 255 ) NOT NULL,
`processStep` INT NOT NULL,
`processLine` VARCHAR( 255 ) NOT NULL,
INDEX `processLineIndex` (processLine),
FOREIGN KEY (processLine) REFERENCES ProcessLine(name)
  ON DELETE CASCADE
) ENGINE = INNODB;


#opretter Drying
CREATE TABLE `carletti`.`Drying` (
`id` INT NOT NULL PRIMARY KEY,
INDEX `idIndex` (id),
FOREIGN KEY (id) REFERENCES Process(id)
  ON DELETE CASCADE,
`minTime` BIGINT NOT NULL,
`idealTime` BIGINT NOT NULL,
`maxTime` BIGINT NOT NULL
) ENGINE = INNODB;
  
#opretter SubProcess
CREATE TABLE `carletti`.`SubProcess` (
`id` INT NOT NULL PRIMARY KEY,
INDEX `idIndex` (id),
FOREIGN KEY (id) REFERENCES Process(id)
  ON DELETE CASCADE,
`name` VARCHAR ( 255 ) NOT NULL,
`description` TEXT NOT NULL,
`treatmentTime` BIGINT NOT NULL,
`temperature` DOUBLE NOT NULL
) ENGINE = INNODB;

#opretter ProcessLog
CREATE TABLE `carletti`.`ProcessLog` (
`id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`startTime` BIGINT NOT NULL,
`endTime` BIGINT NOT NULL,
`process` INT NOT NULL,
`storingSpace`VARCHAR ( 255 ) NOT NULL,
`intermediateProduct` VARCHAR ( 255 ) NOT NULL,
INDEX `processIndex` (process),
INDEX `intermediateProductIndex` (intermediateProduct),
FOREIGN KEY (process) REFERENCES Process(id)
  ON DELETE CASCADE,
FOREIGN KEY (intermediateProduct) REFERENCES IntermediateProduct(id)
  ON DELETE CASCADE
) ENGINE = INNODB;

#opretter en table som laver association mellem Depot og Drying
CREATE TABLE `carletti`.`depotDryingAssociation` (
`depot` VARCHAR ( 255 ) NOT NULL,
`drying` INT NOT NULL,
INDEX `depotIndex` (depot),
INDEX `dryingIndex` (drying),
FOREIGN KEY (depot) REFERENCES Depot(name)
  ON DELETE CASCADE,
FOREIGN KEY (drying) REFERENCES Drying(id)
  ON DELETE CASCADE
) ENGINE = INNODB;